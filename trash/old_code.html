app.directive('medNotes', function () {
    return {
        /*restrict: 'E',
        scope: {
            value: '='
        },*/
        template: '<ul index="{{$index}}"><li ng-repeat="note in med.notes" class="med-note-item"><i class="fa fa-file-text-o med-note-icon"></i><span class="med-note-remove"><a href="javascript:void(0);" ng-click="removeNote($index)" title="Remove note"><i class="fa fa-close"></i></a></span> <edit-in-place class="med-note" value="note.text"></edit-in-place></li></ul><ul class="hidden-print"><li><i class="fa fa-plus"></i> <a href="javascript:void(0);" ng-click="addNote($index)">Add note</a></li></ul>',
		link: function ($scope, element, attrs) {
			element.addClass('med-notes');

			$scope.addNote = function (index) {
				$scope.meds[index].notes.push({text:'New note'});
				//element.html('<edit-in-place value="' + $scope.med.indication + '"></edit-in-place>');
			};
			
			$scope.removeNote = function(index) {
				var med = element.find('ul').attr('index');
				if(confirm("Are you sure you want to remove this note?")){
					$scope.meds[med].notes.splice(index, 1);
				};
			};

		}
	};
});




